<!--
  ~ This file is part of Email4n6.
  ~ Copyright (C) 2018  Marten4n6
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU General Public License as published by
  ~ the Free Software Foundation, either version 3 of the License, or
  ~ (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public License
  ~ along with this program.  If not, see <http://www.gnu.org/licenses/>.
  -->
<html>
<head>
    <title>${case.name}</title>
    <meta name="GENERATOR" content="Email4n6">
    <style type="text/css">.wrap { word-wrap:break-word }</style>
    <link href="Report.css" rel="stylesheet" type="text/css">
</head>

<body>

<#if page_number == 1>
    <div class="casedetails">
        <h2>${case.name}</h2>
        <font class="fieldtitle">Report generated by</font> Email4n6<br>
        <font class="fieldtitle">Case investigator:</font> ${case.investigator}<br>
        <font class="fieldtitle">Case description:</font> ${case.description}<br>
        <br>
    </div>

    <div class="EvObjList">
        <div class="fieldtitle">Evidence file(s):</div>

        <#list case.sources as source>
            ${source} <br/>
        </#list>
        <br>
    </div>
</#if>

<h3 class="RTname" ID="RT3">${items?size} items</h3>
<#assign "itemnumber" = 0>
<#assign "columnwidth" = "">

<#if columns == 1>
    <#assign "columnwidth" = "100%">
<#elseif columns == 2>
    <#assign "columnwidth" = "50%">
<#elseif columns == 3>
    <#assign "columnwidth" = "33%">
<#elseif columns == 4>
    <#assign "columnwidth" = "25%">
<#elseif columns == 5>
    <#assign "columnwidth" = "20%">
</#if>

<#list items as item>
    <#if itemnumber % columns == 0>
        <#if itemnumber != 0>
            <#-- End of this table. -->

                </tr>
                </table>
        </#if>

        <#-- Create a new table -->
        <table border="1" cellpadding="3" cellspacing="0" width="100%">
            <tr>
    </#if>

    <td width="${columnwidth}" valign="top" class="wrap">
        <p>
            <font class="IncrNo">${itemnumber + 1}</font><br>
            <font class="RTfield">Name</font>: <font class="RTfilename">${item.subject}</font><br>
            <a href="Files_${report_name}/${item.id}.html">Link</a><br></p>
        </p>
    </td>

    <#assign itemnumber++>
</#list>
</body>

<#-- Close off the last table -->
</tr>
</table>

<div>
    <#if page_number != 1>
        <#assign "previouspage" = page_number - 1>
        <a class="nextLink" style="float: left; width: 150px;" href="${report_name}_${previouspage}.html">Go back to previous page.</a>
    </#if>
</div>

<div align="right">
    <#if has_next_page>
        <#assign "nextpage" = page_number + 1>
        <a class="nextLink" style="width:calc(100%-150px);" href="${report_name}_${nextpage}.html">Continue to the next page.</a>
    </#if>
</div>

</html>